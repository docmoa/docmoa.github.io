import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as n,c as a,h as e}from"./app-DVMlqOhY.js";const l={},t=e(`<h1 id="state-rm" tabindex="-1"><a class="header-anchor" href="#state-rm"><span>State rm</span></a></h1><ul><li><p>현상</p><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">... googleapi: Error 400: Invalid request: Invalid request since instance is not running.</span>
<span class="line"></span></code></pre></div><p>: Terraform을 통하지 않고 리소스가 삭제되어, 해당 리소스를 찾지 못하는 상황 발생</p></li><li><p>State 삭제</p><p>Local 환경의 terraform에 remote를 Terraform cloud로 지정</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre class="language-json"><code><span class="line">terraform <span class="token punctuation">{</span></span>
<span class="line">  required_version = <span class="token string">&quot;&gt;= 0.12&quot;</span></span>
<span class="line">  backend <span class="token string">&quot;remote&quot;</span> <span class="token punctuation">{</span></span>
<span class="line">    hostname = <span class="token string">&quot;app.terraform.io&quot;</span></span>
<span class="line">    organization = <span class="token string">&quot;lguplus&quot;</span></span>
<span class="line"></span>
<span class="line">    workspaces <span class="token punctuation">{</span></span>
<span class="line">      name = <span class="token string">&quot;kids_library&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>state 리스트 확인 <code>terraform state list</code></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">my-workspace <span class="token operator">&gt;</span> terraform state list</span>
<span class="line">random_pet.sql</span>
<span class="line">module.Cluster_GKE.google_container_cluster.k8sexample</span>
<span class="line">module.Cluster_GKE.google_container_node_pool.pool_1</span>
<span class="line">module.Cluster_GKE.google_container_node_pool.pool_2</span>
<span class="line">module.gcs_buckets.google_storage_bucket.buckets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">module.sql-db.google_sql_database.default</span>
<span class="line">module.sql-db.google_sql_database_instance.default</span>
<span class="line">module.sql-db.google_sql_user.default</span>
<span class="line">module.sql-db.null_resource.module_depends_on</span>
<span class="line">module.sql-db.random_id.user-password</span>
<span class="line">module.network.module.routes.google_compute_route.route<span class="token punctuation">[</span><span class="token string">&quot;egress-internet&quot;</span><span class="token punctuation">]</span></span>
<span class="line">module.network.module.subnets.google_compute_subnetwork.subnetwork<span class="token punctuation">[</span><span class="token string">&quot;asia-northeast3/fc-kidslib-stg-subnet-1&quot;</span><span class="token punctuation">]</span></span>
<span class="line">module.network.module.vpc.google_compute_network.network</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>존재하지 않는 resource를 삭제 <code>terraform state rm [resource_name]</code></p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">my-workspace <span class="token operator">&gt;</span> terraform state <span class="token function">rm</span> module.sql-db</span>
<span class="line">Removed module.sql-db.google_sql_database.default</span>
<span class="line">Removed module.sql-db.google_sql_database_instance.default</span>
<span class="line">Removed module.sql-db.google_sql_user.default</span>
<span class="line">Removed module.sql-db.null_resource.module_depends_on</span>
<span class="line">Removed module.sql-db.random_id.user-password</span>
<span class="line">Successfully removed <span class="token number">5</span> resource instance<span class="token punctuation">(</span>s<span class="token punctuation">)</span>.</span>
<span class="line"></span></code></pre></div></li></ul>`,2),o=[t];function p(i,r){return n(),a("div",null,o)}const u=s(l,[["render",p],["__file","StateRemove.html.vue"]]),m=JSON.parse('{"path":"/04-HashiCorp/03-Terraform/04-TroubleShooting/StateRemove.html","title":"State rm","lang":"ko-KR","frontmatter":{"description":"Terraform State Maintenance","tag":["Terraform","State"],"head":[["meta",{"property":"og:url","content":"https://docmoa.github.io/04-HashiCorp/03-Terraform/04-TroubleShooting/StateRemove.html"}],["meta",{"property":"og:site_name","content":"docmoa"}],["meta",{"property":"og:title","content":"State rm"}],["meta",{"property":"og:description","content":"Terraform State Maintenance"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2023-09-18T13:12:54.000Z"}],["meta",{"property":"article:tag","content":"Terraform"}],["meta",{"property":"article:tag","content":"State"}],["meta",{"property":"article:modified_time","content":"2023-09-18T13:12:54.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"State rm\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-09-18T13:12:54.000Z\\",\\"author\\":[]}"]]},"headers":[],"git":{"createdTime":1642083602000,"updatedTime":1695042774000,"contributors":[{"name":"Administrator","email":"admin@example.com","commits":1},{"name":"Great-Stone","email":"hahohh@gmail.com","commits":1}]},"readingTime":{"minutes":1.93,"words":116},"filePathRelative":"04-HashiCorp/03-Terraform/04-TroubleShooting/StateRemove.md","localizedDate":"2022년 1월 13일","excerpt":"\\n<ul>\\n<li>\\n<p>현상</p>\\n<div class=\\"language-text\\" data-highlighter=\\"prismjs\\" data-ext=\\"text\\" data-title=\\"text\\"><pre class=\\"language-text\\"><code><span class=\\"line\\">... googleapi: Error 400: Invalid request: Invalid request since instance is not running.</span>\\n<span class=\\"line\\"></span></code></pre></div><p>: Terraform을 통하지 않고 리소스가 삭제되어, 해당 리소스를 찾지 못하는 상황 발생</p>\\n</li>\\n<li>\\n<p>State 삭제</p>\\n<p>Local 환경의 terraform에 remote를 Terraform cloud로 지정</p>\\n<div class=\\"language-json\\" data-highlighter=\\"prismjs\\" data-ext=\\"json\\" data-title=\\"json\\"><pre class=\\"language-json\\"><code><span class=\\"line\\">terraform <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  required_version = <span class=\\"token string\\">\\"&gt;= 0.12\\"</span></span>\\n<span class=\\"line\\">  backend <span class=\\"token string\\">\\"remote\\"</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">    hostname = <span class=\\"token string\\">\\"app.terraform.io\\"</span></span>\\n<span class=\\"line\\">    organization = <span class=\\"token string\\">\\"lguplus\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">    workspaces <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">      name = <span class=\\"token string\\">\\"kids_library\\"</span></span>\\n<span class=\\"line\\">    <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\">  <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span></code></pre></div><p>state 리스트 확인 <code>terraform state list</code></p>\\n<div class=\\"language-bash\\" data-highlighter=\\"prismjs\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"line\\">my-workspace <span class=\\"token operator\\">&gt;</span> terraform state list</span>\\n<span class=\\"line\\">random_pet.sql</span>\\n<span class=\\"line\\">module.Cluster_GKE.google_container_cluster.k8sexample</span>\\n<span class=\\"line\\">module.Cluster_GKE.google_container_node_pool.pool_1</span>\\n<span class=\\"line\\">module.Cluster_GKE.google_container_node_pool.pool_2</span>\\n<span class=\\"line\\">module.gcs_buckets.google_storage_bucket.buckets<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\">module.sql-db.google_sql_database.default</span>\\n<span class=\\"line\\">module.sql-db.google_sql_database_instance.default</span>\\n<span class=\\"line\\">module.sql-db.google_sql_user.default</span>\\n<span class=\\"line\\">module.sql-db.null_resource.module_depends_on</span>\\n<span class=\\"line\\">module.sql-db.random_id.user-password</span>\\n<span class=\\"line\\">module.network.module.routes.google_compute_route.route<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\\"egress-internet\\"</span><span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\">module.network.module.subnets.google_compute_subnetwork.subnetwork<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\\"asia-northeast3/fc-kidslib-stg-subnet-1\\"</span><span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\">module.network.module.vpc.google_compute_network.network</span>\\n<span class=\\"line\\"></span></code></pre></div><p>존재하지 않는 resource를 삭제 <code>terraform state rm [resource_name]</code></p>\\n<div class=\\"language-bash\\" data-highlighter=\\"prismjs\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"line\\">my-workspace <span class=\\"token operator\\">&gt;</span> terraform state <span class=\\"token function\\">rm</span> module.sql-db</span>\\n<span class=\\"line\\">Removed module.sql-db.google_sql_database.default</span>\\n<span class=\\"line\\">Removed module.sql-db.google_sql_database_instance.default</span>\\n<span class=\\"line\\">Removed module.sql-db.google_sql_user.default</span>\\n<span class=\\"line\\">Removed module.sql-db.null_resource.module_depends_on</span>\\n<span class=\\"line\\">Removed module.sql-db.random_id.user-password</span>\\n<span class=\\"line\\">Successfully removed <span class=\\"token number\\">5</span> resource instance<span class=\\"token punctuation\\">(</span>s<span class=\\"token punctuation\\">)</span>.</span>\\n<span class=\\"line\\"></span></code></pre></div></li>\\n</ul>"}');export{u as comp,m as data};
