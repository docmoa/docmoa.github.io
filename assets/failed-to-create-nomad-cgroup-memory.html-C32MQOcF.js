import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,h as e}from"./app-DVMlqOhY.js";const p={},t=e(`<h1 id="failed-to-start-failed-to-create-nomad-cgroup-memory" tabindex="-1"><a class="header-anchor" href="#failed-to-start-failed-to-create-nomad-cgroup-memory"><span>Failed to start (failed to create nomad cgroup memory)</span></a></h1><p>오류 메시지는 파일 시스템이 읽기 전용으로 마운트된 Linux 시스템에서 <code>cgroup</code>을 수정하려고 할 때 문제가 있음을 나타냅니다. 이 문제는 컨테이너 및 컨테이너화되지 않은 애플리케이션을 오케스트레이션하는 클러스터 관리자 및 스케줄러인 Nomad가 관리하는 환경에서 발생할 수 있습니다.</p><h2 id="error-log" tabindex="-1"><a class="header-anchor" href="#error-log"><span>Error log</span></a></h2><div class="language-log" data-highlighter="prismjs" data-ext="log" data-title="log"><pre class="language-log"><code><span class="line"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"><span class="token date number">Apr 25</span> <span class="token time number">11:27:31</span> raspberrypi nomad<span class="token punctuation">[</span><span class="token number">20120</span><span class="token punctuation">]</span><span class="token operator">:</span>     <span class="token date number">2024-04-25T</span><span class="token time number">11:27:31.007+0100</span> <span class="token punctuation">[</span><span class="token level info keyword">INFO</span><span class="token punctuation">]</span>  <span class="token property">client.proclib.cg1:</span> <span class="token property">initializing nomad cgroups:</span> cores<span class="token operator">=</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">3</span></span>
<span class="line"><span class="token date number">Apr 25</span> <span class="token time number">11:27:31</span> raspberrypi nomad<span class="token punctuation">[</span><span class="token number">20120</span><span class="token punctuation">]</span><span class="token operator">:</span>     <span class="token date number">2024-04-25T</span><span class="token time number">11:27:31.008+0100</span> <span class="token punctuation">[</span><span class="token level error important">ERROR</span><span class="token punctuation">]</span> <span class="token property">agent:</span> <span class="token property">error starting agent:</span> error<span class="token operator">=</span><span class="token string">&quot;client setup failed: failed to initialize process manager: failed to create nomad cgroup memory: mkdir /sys/fs/cgroup/memory: read-only file system&quot;</span></span>
<span class="line"><span class="token date number">Apr 25</span> <span class="token time number">11:27:31</span> raspberrypi systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span> nomad<span class="token punctuation">.</span>service<span class="token operator">:</span> Service RestartSec<span class="token operator">=</span><span class="token number">100ms</span> expired<span class="token punctuation">,</span> scheduling restart<span class="token punctuation">.</span></span>
<span class="line"></span></code></pre></div><h2 id="check-filesystem-mount-options" tabindex="-1"><a class="header-anchor" href="#check-filesystem-mount-options"><span>Check Filesystem Mount Options</span></a></h2><p>파일 시스템이 읽기 전용으로 마운트되지 않았는지 확인합니다. 마운트 또는 findmnt 명령을 사용하여 마운트 옵션을 확인할 수 있습니다:</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">mount</span> <span class="token operator">|</span> <span class="token function">grep</span> cgroup</span>
<span class="line"></span></code></pre></div><div class="language-log line-numbers-mode" data-highlighter="prismjs" data-ext="log" data-title="log"><pre class="language-log"><code><span class="line"><span class="token operator">#</span>Current cgroup</span>
<span class="line">tmpfs on <span class="token file-path string">/sys/fs/cgroup</span> type tmpfs <span class="token operator">(</span>ro<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token number">755</span><span class="token operator">)</span></span>
<span class="line">cgroup2 on <span class="token file-path string">/sys/fs/cgroup/unified</span> type cgroup2 <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>nsdelegate<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/systemd</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>xattr<span class="token punctuation">,</span>name<span class="token operator">=</span>systemd<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/devices</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>devices<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/net_cls</span><span class="token punctuation">,</span>net_prio type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>net_cls<span class="token punctuation">,</span>net_prio<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/cpu</span><span class="token punctuation">,</span>cpuacct type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>cpu<span class="token punctuation">,</span>cpuacct<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/pids</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>pids<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/freezer</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>freezer<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/cpuset</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>cpuset<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/blkio</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>blkio<span class="token operator">)</span></span>
<span class="line">cgroup on <span class="token file-path string">/sys/fs/cgroup/perf_event</span> type cgroup <span class="token operator">(</span>rw<span class="token punctuation">,</span>nosuid<span class="token punctuation">,</span>nodev<span class="token punctuation">,</span>noexec<span class="token punctuation">,</span>relatime<span class="token punctuation">,</span>perf_event<span class="token operator">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="add-read-write-to-cgroup" tabindex="-1"><a class="header-anchor" href="#add-read-write-to-cgroup"><span>Add read-write to cgroup</span></a></h2><p><code>ro</code>옵션을 찾습니다. 실제로 읽기 전용인 <code>ro</code>(Read-Only)으로 마운트된 경우 가능하면 <code>rw</code>(Read-Write : 읽기-쓰기)로 마운트 해야 변경 가능합니다.</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">sudo</span> <span class="token function">mount</span> <span class="token parameter variable">-o</span> remount,rw /sys/fs/cgroup</span>
<span class="line"></span></code></pre></div><h2 id="verify-kernel-support-and-parameters" tabindex="-1"><a class="header-anchor" href="#verify-kernel-support-and-parameters"><span>Verify Kernel Support and Parameters</span></a></h2><p>커널이 cgroups를 지원하고 필요한 모든 cgroup 하위 시스템이 활성화되어 있는지 확인하세요. cgroups와 관련된 커널 매개변수를 조정하거나 활성화해야 할 수도 있습니다. 현재 설정을 확인합니다:</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">cat</span> /proc/cgroups</span>
<span class="line"></span></code></pre></div><div class="language-ini line-numbers-mode" data-highlighter="prismjs" data-ext="ini" data-title="ini"><pre class="language-ini"><code><span class="line"><span class="token comment">#subsys_name    hierarchy       num_cgroups     enabled</span></span>
<span class="line">cpuset  7       6       1</span>
<span class="line">cpu     4       77      1</span>
<span class="line">cpuacct 4       77      1</span>
<span class="line">blkio   8       76      1</span>
<span class="line">memory  0       85      0</span>
<span class="line">devices 2       76      1</span>
<span class="line">freezer 6       2       1</span>
<span class="line">net_cls 3       1       1</span>
<span class="line">perf_event      9       1       1</span>
<span class="line">net_prio        3       1       1</span>
<span class="line">pids    5       83      1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,15),o=[t];function c(r,l){return s(),a("div",null,o)}const d=n(p,[["render",c],["__file","failed-to-create-nomad-cgroup-memory.html.vue"]]),m=JSON.parse('{"path":"/04-HashiCorp/07-Nomad/03-TroubleShooting/failed-to-create-nomad-cgroup-memory.html","title":"Failed to start (failed to create nomad cgroup memory)","lang":"ko-KR","frontmatter":{"description":"failed to create nomad cgroup memory","tag":["Nomad","Error"],"head":[["meta",{"property":"og:url","content":"https://docmoa.github.io/04-HashiCorp/07-Nomad/03-TroubleShooting/failed-to-create-nomad-cgroup-memory.html"}],["meta",{"property":"og:site_name","content":"docmoa"}],["meta",{"property":"og:title","content":"Failed to start (failed to create nomad cgroup memory)"}],["meta",{"property":"og:description","content":"failed to create nomad cgroup memory"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-04-25T10:38:17.000Z"}],["meta",{"property":"article:tag","content":"Nomad"}],["meta",{"property":"article:tag","content":"Error"}],["meta",{"property":"article:modified_time","content":"2024-04-25T10:38:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Failed to start (failed to create nomad cgroup memory)\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-25T10:38:17.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Error log","slug":"error-log","link":"#error-log","children":[]},{"level":2,"title":"Check Filesystem Mount Options","slug":"check-filesystem-mount-options","link":"#check-filesystem-mount-options","children":[]},{"level":2,"title":"Add read-write to cgroup","slug":"add-read-write-to-cgroup","link":"#add-read-write-to-cgroup","children":[]},{"level":2,"title":"Verify Kernel Support and Parameters","slug":"verify-kernel-support-and-parameters","link":"#verify-kernel-support-and-parameters","children":[]}],"git":{"createdTime":1714041497000,"updatedTime":1714041497000,"contributors":[{"name":"Great-Stone","email":"hahohh@gmail.com","commits":1}]},"readingTime":{"minutes":5.47,"words":328},"filePathRelative":"04-HashiCorp/07-Nomad/03-TroubleShooting/failed-to-create-nomad-cgroup-memory.md","localizedDate":"2024년 4월 25일","excerpt":"\\n<p>오류 메시지는 파일 시스템이 읽기 전용으로 마운트된 Linux 시스템에서 <code>cgroup</code>을 수정하려고 할 때 문제가 있음을 나타냅니다. 이 문제는 컨테이너 및 컨테이너화되지 않은 애플리케이션을 오케스트레이션하는 클러스터 관리자 및 스케줄러인 Nomad가 관리하는 환경에서 발생할 수 있습니다.</p>\\n<h2>Error log</h2>\\n<div class=\\"language-log\\" data-highlighter=\\"prismjs\\" data-ext=\\"log\\" data-title=\\"log\\"><pre class=\\"language-log\\"><code><span class=\\"line\\"><span class=\\"token punctuation\\">.</span><span class=\\"token punctuation\\">.</span><span class=\\"token punctuation\\">.</span></span>\\n<span class=\\"line\\"><span class=\\"token date number\\">Apr 25</span> <span class=\\"token time number\\">11:27:31</span> raspberrypi nomad<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">20120</span><span class=\\"token punctuation\\">]</span><span class=\\"token operator\\">:</span>     <span class=\\"token date number\\">2024-04-25T</span><span class=\\"token time number\\">11:27:31.007+0100</span> <span class=\\"token punctuation\\">[</span><span class=\\"token level info keyword\\">INFO</span><span class=\\"token punctuation\\">]</span>  <span class=\\"token property\\">client.proclib.cg1:</span> <span class=\\"token property\\">initializing nomad cgroups:</span> cores<span class=\\"token operator\\">=</span><span class=\\"token number\\">0</span><span class=\\"token operator\\">-</span><span class=\\"token number\\">3</span></span>\\n<span class=\\"line\\"><span class=\\"token date number\\">Apr 25</span> <span class=\\"token time number\\">11:27:31</span> raspberrypi nomad<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">20120</span><span class=\\"token punctuation\\">]</span><span class=\\"token operator\\">:</span>     <span class=\\"token date number\\">2024-04-25T</span><span class=\\"token time number\\">11:27:31.008+0100</span> <span class=\\"token punctuation\\">[</span><span class=\\"token level error important\\">ERROR</span><span class=\\"token punctuation\\">]</span> <span class=\\"token property\\">agent:</span> <span class=\\"token property\\">error starting agent:</span> error<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"client setup failed: failed to initialize process manager: failed to create nomad cgroup memory: mkdir /sys/fs/cgroup/memory: read-only file system\\"</span></span>\\n<span class=\\"line\\"><span class=\\"token date number\\">Apr 25</span> <span class=\\"token time number\\">11:27:31</span> raspberrypi systemd<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">1</span><span class=\\"token punctuation\\">]</span><span class=\\"token operator\\">:</span> nomad<span class=\\"token punctuation\\">.</span>service<span class=\\"token operator\\">:</span> Service RestartSec<span class=\\"token operator\\">=</span><span class=\\"token number\\">100ms</span> expired<span class=\\"token punctuation\\">,</span> scheduling restart<span class=\\"token punctuation\\">.</span></span>\\n<span class=\\"line\\"></span></code></pre></div>"}');export{d as comp,m as data};
