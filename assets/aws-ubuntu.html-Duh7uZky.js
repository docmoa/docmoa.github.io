import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,h as p}from"./app-DVMlqOhY.js";const t={},e=p(`<h1 id="aws-packer-sample-ubuntu" tabindex="-1"><a class="header-anchor" href="#aws-packer-sample-ubuntu"><span>AWS Packer Sample - Ubuntu</span></a></h1><h2 id="ubuntu-pkr-hcl" tabindex="-1"><a class="header-anchor" href="#ubuntu-pkr-hcl"><span>ubuntu.pkr.hcl</span></a></h2><div class="language-hcl line-numbers-mode" data-highlighter="prismjs" data-ext="hcl" data-title="hcl"><pre class="language-hcl"><code><span class="line"><span class="token comment"># packer init client.pkr.hcl</span></span>
<span class="line"><span class="token comment"># packer build -force .</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">variable<span class="token type variable"> &quot;region&quot; </span></span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">default</span> <span class="token punctuation">=</span> <span class="token string">&quot;ap-northeast-2&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">variable<span class="token type variable"> &quot;cni-version&quot; </span></span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">default</span> <span class="token punctuation">=</span> <span class="token string">&quot;1.0.1&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">packer</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">required_plugins</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">amazon</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;&gt;= 0.0.2&quot;</span></span>
<span class="line">      <span class="token property">source</span>  <span class="token punctuation">=</span> <span class="token string">&quot;github.com/hashicorp/amazon&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">source <span class="token string">&quot;amazon-ebs&quot;</span> <span class="token string">&quot;example&quot;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">ami_name</span>      <span class="token punctuation">=</span> <span class="token string">&quot;gs_demo_ubuntu_{{timestamp}}&quot;</span></span>
<span class="line">  <span class="token property">instance_type</span> <span class="token punctuation">=</span> <span class="token string">&quot;t3.micro&quot;</span></span>
<span class="line">  <span class="token property">region</span>        <span class="token punctuation">=</span> var.region</span>
<span class="line">  <span class="token keyword">source_ami_filter</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">filters</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">name</span>                <span class="token punctuation">=</span> <span class="token string">&quot;ubuntu/images/*ubuntu-bionic-18.04-amd64-server-*&quot;</span></span>
<span class="line">      <span class="token property">root-device-type</span>    <span class="token punctuation">=</span> <span class="token string">&quot;ebs&quot;</span></span>
<span class="line">      <span class="token property">virtualization-type</span> <span class="token punctuation">=</span> <span class="token string">&quot;hvm&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token property">most_recent</span> <span class="token punctuation">=</span> <span class="token boolean">true</span></span>
<span class="line">    <span class="token property">owners</span>      <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;099720109477&quot;</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token property">ssh_username</span> <span class="token punctuation">=</span> <span class="token string">&quot;ubuntu&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">build</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">sources</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;source.amazon-ebs.example&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">provisioner<span class="token type variable"> &quot;file&quot; </span></span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">source</span>      <span class="token punctuation">=</span> <span class="token string">&quot;./file/&quot;</span></span>
<span class="line">    <span class="token property">destination</span> <span class="token punctuation">=</span> <span class="token string">&quot;/tmp&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">provisioner<span class="token type variable"> &quot;shell&quot; </span></span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">inline</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token string">&quot;set -x&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;echo Connected via Consul/Nomad client at \\&quot;<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>build<span class="token punctuation">.</span>User<span class="token punctuation">}</span></span>@<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>build<span class="token punctuation">.</span>Host<span class="token punctuation">}</span></span>:<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span>build<span class="token punctuation">.</span>Port<span class="token punctuation">}</span></span>\\&quot;&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get update&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get install -y apt-transport-https ca-certificates curl gnupg lsb-release&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get update&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-add-repository \\&quot;deb [arch=amd64] https://apt.releases.hashicorp.com bionic main\\&quot;&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get update &amp;&amp; sudo apt-get -y install consul nomad netcat nginx&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo add-apt-repository \\&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\\&quot;&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get update&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo apt-get install -y docker-ce openjdk-11-jdk&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;curl -sL -o cni-plugins.tgz https://github.com/containernetworking/plugins/releases/download/v<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">cni</span>-version<span class="token punctuation">}</span></span>/cni-plugins-linux-amd64-v<span class="token interpolation"><span class="token punctuation">$</span><span class="token punctuation">{</span><span class="token keyword">var</span><span class="token punctuation">.</span><span class="token type variable">cni</span>-version<span class="token punctuation">}</span></span>.tgz&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo mkdir -p /opt/cni/bin&quot;</span>,</span>
<span class="line">      <span class="token string">&quot;sudo tar -C /opt/cni/bin -xzf cni-plugins.tgz&quot;</span>,</span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),l=[e];function o(c,i){return s(),a("div",null,l)}const k=n(t,[["render",o],["__file","aws-ubuntu.html.vue"]]),d=JSON.parse('{"path":"/04-HashiCorp/01-Packer/05-SamplePkr/aws-ubuntu.html","title":"AWS Packer Sample - Ubuntu","lang":"ko-KR","frontmatter":{"description":"Packer Sample","tag":["Packer","Sample","aws"],"head":[["meta",{"property":"og:url","content":"https://docmoa.github.io/04-HashiCorp/01-Packer/05-SamplePkr/aws-ubuntu.html"}],["meta",{"property":"og:site_name","content":"docmoa"}],["meta",{"property":"og:title","content":"AWS Packer Sample - Ubuntu"}],["meta",{"property":"og:description","content":"Packer Sample"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2023-09-18T13:12:54.000Z"}],["meta",{"property":"article:tag","content":"Packer"}],["meta",{"property":"article:tag","content":"Sample"}],["meta",{"property":"article:tag","content":"aws"}],["meta",{"property":"article:modified_time","content":"2023-09-18T13:12:54.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"AWS Packer Sample - Ubuntu\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-09-18T13:12:54.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"ubuntu.pkr.hcl","slug":"ubuntu-pkr-hcl","link":"#ubuntu-pkr-hcl","children":[]}],"git":{"createdTime":1639995661000,"updatedTime":1695042774000,"contributors":[{"name":"Administrator","email":"admin@example.com","commits":1},{"name":"Great-Stone","email":"hahohh@gmail.com","commits":1}]},"readingTime":{"minutes":3.52,"words":211},"filePathRelative":"04-HashiCorp/01-Packer/05-SamplePkr/aws-ubuntu.md","localizedDate":"2021년 12월 20일","excerpt":"\\n<h2>ubuntu.pkr.hcl</h2>\\n<div class=\\"language-hcl\\" data-highlighter=\\"prismjs\\" data-ext=\\"hcl\\" data-title=\\"hcl\\"><pre class=\\"language-hcl\\"><code><span class=\\"line\\"><span class=\\"token comment\\"># packer init client.pkr.hcl</span></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># packer build -force .</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">variable<span class=\\"token type variable\\"> \\"region\\" </span></span><span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">default</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"ap-northeast-2\\"</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">variable<span class=\\"token type variable\\"> \\"cni-version\\" </span></span><span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">default</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"1.0.1\\"</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">packer</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token keyword\\">required_plugins</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">amazon</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">      <span class=\\"token property\\">version</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"&gt;= 0.0.2\\"</span></span>\\n<span class=\\"line\\">      <span class=\\"token property\\">source</span>  <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"github.com/hashicorp/amazon\\"</span></span>\\n<span class=\\"line\\">    <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\">  <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">source <span class=\\"token string\\">\\"amazon-ebs\\"</span> <span class=\\"token string\\">\\"example\\"</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">ami_name</span>      <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"gs_demo_ubuntu_{{timestamp}}\\"</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">instance_type</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"t3.micro\\"</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">region</span>        <span class=\\"token punctuation\\">=</span> var.region</span>\\n<span class=\\"line\\">  <span class=\\"token keyword\\">source_ami_filter</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">filters</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">      <span class=\\"token property\\">name</span>                <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"ubuntu/images/*ubuntu-bionic-18.04-amd64-server-*\\"</span></span>\\n<span class=\\"line\\">      <span class=\\"token property\\">root-device-type</span>    <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"ebs\\"</span></span>\\n<span class=\\"line\\">      <span class=\\"token property\\">virtualization-type</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"hvm\\"</span></span>\\n<span class=\\"line\\">    <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">most_recent</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token boolean\\">true</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">owners</span>      <span class=\\"token punctuation\\">=</span> <span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\\"099720109477\\"</span><span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\">  <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">ssh_username</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"ubuntu\\"</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">build</span> <span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">  <span class=\\"token property\\">sources</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\\"source.amazon-ebs.example\\"</span><span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">  <span class=\\"token keyword\\">provisioner<span class=\\"token type variable\\"> \\"file\\" </span></span><span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">source</span>      <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"./file/\\"</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">destination</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token string\\">\\"/tmp\\"</span></span>\\n<span class=\\"line\\">  <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">  <span class=\\"token keyword\\">provisioner<span class=\\"token type variable\\"> \\"shell\\" </span></span><span class=\\"token punctuation\\">{</span></span>\\n<span class=\\"line\\">    <span class=\\"token property\\">inline</span> <span class=\\"token punctuation\\">=</span> <span class=\\"token punctuation\\">[</span></span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"set -x\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"echo Connected via Consul/Nomad client at \\\\\\"<span class=\\"token interpolation\\"><span class=\\"token punctuation\\">$</span><span class=\\"token punctuation\\">{</span>build<span class=\\"token punctuation\\">.</span>User<span class=\\"token punctuation\\">}</span></span>@<span class=\\"token interpolation\\"><span class=\\"token punctuation\\">$</span><span class=\\"token punctuation\\">{</span>build<span class=\\"token punctuation\\">.</span>Host<span class=\\"token punctuation\\">}</span></span>:<span class=\\"token interpolation\\"><span class=\\"token punctuation\\">$</span><span class=\\"token punctuation\\">{</span>build<span class=\\"token punctuation\\">.</span>Port<span class=\\"token punctuation\\">}</span></span>\\\\\\"\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get update\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get install -y apt-transport-https ca-certificates curl gnupg lsb-release\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get update\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-add-repository \\\\\\"deb [arch=amd64] https://apt.releases.hashicorp.com bionic main\\\\\\"\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get update &amp;&amp; sudo apt-get -y install consul nomad netcat nginx\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo add-apt-repository \\\\\\"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\\\\\\"\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get update\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo apt-get install -y docker-ce openjdk-11-jdk\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"curl -sL -o cni-plugins.tgz https://github.com/containernetworking/plugins/releases/download/v<span class=\\"token interpolation\\"><span class=\\"token punctuation\\">$</span><span class=\\"token punctuation\\">{</span><span class=\\"token keyword\\">var</span><span class=\\"token punctuation\\">.</span><span class=\\"token type variable\\">cni</span>-version<span class=\\"token punctuation\\">}</span></span>/cni-plugins-linux-amd64-v<span class=\\"token interpolation\\"><span class=\\"token punctuation\\">$</span><span class=\\"token punctuation\\">{</span><span class=\\"token keyword\\">var</span><span class=\\"token punctuation\\">.</span><span class=\\"token type variable\\">cni</span>-version<span class=\\"token punctuation\\">}</span></span>.tgz\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo mkdir -p /opt/cni/bin\\"</span>,</span>\\n<span class=\\"line\\">      <span class=\\"token string\\">\\"sudo tar -C /opt/cni/bin -xzf cni-plugins.tgz\\"</span>,</span>\\n<span class=\\"line\\">    <span class=\\"token punctuation\\">]</span></span>\\n<span class=\\"line\\">  <span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"><span class=\\"token punctuation\\">}</span></span>\\n<span class=\\"line\\"></span></code></pre></div>"}');export{k as comp,d as data};
