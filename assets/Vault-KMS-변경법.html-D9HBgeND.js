import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as u,o as r,c as d,b as i,w as n,h as l,g as a,a as s}from"./app-DVMlqOhY.js";const k="/assets/3057419103-DsWXKFTH.png?width=760",c="/assets/3057386338-CyHHbZcm.png?width=760",m="/assets/3057320844-DGVF-0Wh.png?width=760",g="/assets/3057189807-Cdvm5kqy.png?width=760",h="/assets/3056829930-D2A0ZS7J.png?width=760",v={},b=l(`<h1 id="eks-vault-auto-unseal에-대한-kms-id-변경-시-설정-법" tabindex="-1"><a class="header-anchor" href="#eks-vault-auto-unseal에-대한-kms-id-변경-시-설정-법"><span>EKS Vault auto unseal에 대한 kms ID 변경 시 설정 법</span></a></h1><h2 id="_1-사전-요구조건-및-kms-id-정보-확인" tabindex="-1"><a class="header-anchor" href="#_1-사전-요구조건-및-kms-id-정보-확인"><span>1. 사전 요구조건 및 KMS ID 정보 확인</span></a></h2><h3 id="_1-1-config-hcl-파일" tabindex="-1"><a class="header-anchor" href="#_1-1-config-hcl-파일"><span>1.1 config.hcl 파일</span></a></h3><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">seal &quot;awskms&quot; {</span>
<span class="line">  region     = &quot;ap-northeast-2&quot;</span>
<span class="line">  kms_key_id = &quot;[kms_key_id]&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre></div><h3 id="_1-2-초기-vault-helm-배포-시-kms-id-설정은-secret으로-관리" tabindex="-1"><a class="header-anchor" href="#_1-2-초기-vault-helm-배포-시-kms-id-설정은-secret으로-관리"><span>1.2 초기 vault helm 배포 시 kms ID 설정은 secret으로 관리</span></a></h3><div class="language-yaml" data-highlighter="prismjs" data-ext="yml" data-title="values.yaml"><pre class="language-yaml"><code><span class="line"><span class="token comment"># 중략</span></span>
<span class="line">    <span class="token key atrule">extraArgs</span><span class="token punctuation">:</span> <span class="token string">&quot;-config=/vault/userconfig/vault-seal-config/config.hcl&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> userconfig<span class="token punctuation">-</span>vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">        <span class="token key atrule">secret</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">defaultMode</span><span class="token punctuation">:</span> <span class="token number">420</span></span>
<span class="line">          <span class="token key atrule">secretName</span><span class="token punctuation">:</span> vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /vault/userconfig/vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">        <span class="token key atrule">name</span><span class="token punctuation">:</span> userconfig<span class="token punctuation">-</span>vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">        <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line"></span></code></pre></div><h3 id="_1-3-kms-id-secret" tabindex="-1"><a class="header-anchor" href="#_1-3-kms-id-secret"><span>1.3 kms ID secret</span></a></h3><figure><img src="`+k+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_2-kms-id-변경" tabindex="-1"><a class="header-anchor" href="#_2-kms-id-변경"><span>2. KMS ID 변경</span></a></h2><h3 id="_2-1-초기-kms-id-확인" tabindex="-1"><a class="header-anchor" href="#_2-1-초기-kms-id-확인"><span>2.1 초기 KMS ID 확인</span></a></h3><div class="language-hcl" data-highlighter="prismjs" data-ext="hcl" data-title="hcl"><pre class="language-hcl"><code><span class="line">seal <span class="token string">&quot;awskms&quot;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">region</span>     <span class="token punctuation">=</span> <span class="token string">&quot;ap-northeast-2&quot;</span></span>
<span class="line">  <span class="token property">kms_key_id</span> <span class="token punctuation">=</span> <span class="token string">&quot;[kms_key_id]&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre></div><h3 id="_2-2-kubernetes에-올라간-config-hcl-정보를-base64-인코딩한-secret-값" tabindex="-1"><a class="header-anchor" href="#_2-2-kubernetes에-올라간-config-hcl-정보를-base64-인코딩한-secret-값"><span>2.2 kubernetes에 올라간 config.hcl 정보를 base64 인코딩한 secret 값</span></a></h3>`,12),_=s("div",{class:"language-text","data-highlighter":"prismjs","data-ext":"text","data-title":"text"},[s("pre",{class:"language-text"},[s("code",null,[s("span",{class:"line"},"c2VhbCAiYXdza21zIiB7CiAgICAgICAgICByZWdpb24gICAgID0gImFwLW5vcnRoZWFzdC0yIgogICAgICAgICAga21zX2tleV9pZCA9ICJkNjJiNDJjYy0wM2UxLTQ5NTAtOTM2NC04ODMwMTQzZjVjNzAiCiAgICAgICAgfQo="),a(`
`),s("span",{class:"line"})])])],-1),f=s("div",{class:"language-hcl","data-highlighter":"prismjs","data-ext":"hcl","data-title":"hcl"},[s("pre",{class:"language-hcl"},[s("code",null,[s("span",{class:"line"},[a("seal "),s("span",{class:"token string"},'"awskms"'),a(),s("span",{class:"token punctuation"},"{")]),a(`
`),s("span",{class:"line"},[a("  "),s("span",{class:"token property"},"region"),a("     "),s("span",{class:"token punctuation"},"="),a(),s("span",{class:"token string"},'"ap-northeast-2"')]),a(`
`),s("span",{class:"line"},[a("  "),s("span",{class:"token property"},"kms_key_id"),a(),s("span",{class:"token punctuation"},"="),a(),s("span",{class:"token string"},'"d62b42cc-03e1-4950-9364-8830143f5c70"')]),a(`
`),s("span",{class:"line"},[s("span",{class:"token punctuation"},"}")]),a(`
`),s("span",{class:"line"})])])],-1),y=l('<h3 id="_2-3-암호화-정보-복호화" tabindex="-1"><a class="header-anchor" href="#_2-3-암호화-정보-복호화"><span>2.3 암호화 정보 복호화</span></a></h3><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-3-vault-배포-시-container-내부-kms-id-값-확인" tabindex="-1"><a class="header-anchor" href="#_2-3-vault-배포-시-container-내부-kms-id-값-확인"><span>2.3 vault 배포 시 Container 내부 KMS ID 값 확인</span></a></h3><figure><img src="'+m+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-3-변경-되는-kms-id-변경" tabindex="-1"><a class="header-anchor" href="#_2-3-변경-되는-kms-id-변경"><span>2.3 변경 되는 KMS ID 변경</span></a></h3><ul><li><code>d62b42cc-03e1-4950-9364-8830143f5c70</code> =&gt; <code>8dc36bf2-c2f8-4686-bba1-f8ef143a2715</code> KMS ID 변경</li></ul><div class="language-text" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">seal &quot;awskms&quot; {</span>
<span class="line">  region     = &quot;ap-northeast-2&quot;</span>
<span class="line">  kms_key_id = &quot;8dc36bf2-c2f8-4686-bba1-f8ef143a2715&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre></div><h3 id="_2-4-변경-된-config-hcl-파일-secret-update" tabindex="-1"><a class="header-anchor" href="#_2-4-변경-된-config-hcl-파일-secret-update"><span>2.4 변경 된 config.hcl 파일 secret update</span></a></h3><div class="language-bash" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">kubectl create secret generic vault-seal-config <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--namespace</span><span class="token operator">=</span>default <span class="token punctuation">\\</span></span>
<span class="line">  --from-file<span class="token operator">=</span>./config.hcl <span class="token punctuation">\\</span></span>
<span class="line">  --dry-run <span class="token parameter variable">-o</span> yaml <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
<span class="line"></span></code></pre></div><h3 id="_2-5-변경-된-kubernetes에-올라간-config-hcl-정보가-암호화-된-secret-값" tabindex="-1"><a class="header-anchor" href="#_2-5-변경-된-kubernetes에-올라간-config-hcl-정보가-암호화-된-secret-값"><span>2.5 변경 된 kubernetes에 올라간 config.hcl 정보가 암호화 된 secret 값</span></a></h3>`,10),x=s("div",{class:"language-text","data-highlighter":"prismjs","data-ext":"text","data-title":"text"},[s("pre",{class:"language-text"},[s("code",null,[s("span",{class:"line"},"c2VhbCAiYXdza21zIiB7CiAgICAgICAgICByZWdpb24gICAgID0gImFwLW5vcnRoZWFzdC0yIgogICAgICAgICAga21zX2tleV9pZCA9ICI4ZGMzNmJmMi1jMmY4LTQ2ODYtYmJhMS1mOGVmMTQzYTI3MTUiCiAgICAgICAgfQo="),a(`
`),s("span",{class:"line"})])])],-1),C=s("div",{class:"language-hcl","data-highlighter":"prismjs","data-ext":"hcl","data-title":"hcl"},[s("pre",{class:"language-hcl"},[s("code",null,[s("span",{class:"line"},[a("seal "),s("span",{class:"token string"},'"awskms"'),a(),s("span",{class:"token punctuation"},"{")]),a(`
`),s("span",{class:"line"},[a("  "),s("span",{class:"token property"},"region"),a("     "),s("span",{class:"token punctuation"},"="),a(),s("span",{class:"token string"},'"ap-northeast-2"')]),a(`
`),s("span",{class:"line"},[a("  "),s("span",{class:"token property"},"kms_key_id"),a(),s("span",{class:"token punctuation"},"="),a(),s("span",{class:"token string"},'"8dc36bf2-c2f8-4686-bba1-f8ef143a2715"')]),a(`
`),s("span",{class:"line"},[s("span",{class:"token punctuation"},"}")]),a(`
`),s("span",{class:"line"})])])],-1),I=l('<h3 id="_2-6-변경-된-암호화-정보-복호화" tabindex="-1"><a class="header-anchor" href="#_2-6-변경-된-암호화-정보-복호화"><span>2.6 변경 된 암호화 정보 복호화</span></a></h3><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-7-변경-된-secret-정보가-실제-pod-내-적용-되어-있는-확인" tabindex="-1"><a class="header-anchor" href="#_2-7-변경-된-secret-정보가-실제-pod-내-적용-되어-있는-확인"><span>2.7 변경 된 secret 정보가 실제 pod 내 적용 되어 있는 확인</span></a></h3><figure><img src="'+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_2-8-kms-id-변경-이후-auto-unseal-정상-작동-확인" tabindex="-1"><a class="header-anchor" href="#_2-8-kms-id-변경-이후-auto-unseal-정상-작동-확인"><span>2.8 KMS ID 변경 이후 auto-unseal 정상 작동 확인</span></a></h3><figure><img src="'+h+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_3-values-yaml" tabindex="-1"><a class="header-anchor" href="#_3-values-yaml"><span>3. values.yaml</span></a></h2><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="values.yaml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">server</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">enterpriseLicense</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">secretName</span><span class="token punctuation">:</span> vault<span class="token punctuation">-</span>ent<span class="token punctuation">-</span>license</span>
<span class="line">  <span class="token key atrule">ha</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span></span>
<span class="line">    <span class="token key atrule">raft</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">      <span class="token key atrule">config</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"></span>
<span class="line">        ui = true</span></span>
<span class="line"></span>
<span class="line">        listener &quot;tcp&quot; <span class="token punctuation">{</span></span>
<span class="line">          tls_disable = 1</span>
<span class="line">          address = &quot;<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>8200&quot;</span>
<span class="line">          cluster_address = &quot;<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>8201&quot;</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">#seal &quot;awskms&quot; {</span></span>
<span class="line">        <span class="token comment">#  region     = &quot;ap-northeast-2&quot;</span></span>
<span class="line">        <span class="token comment">#  kms_key_id = &quot;d62b42cc-03e1-4950-9364-8830143f5c70&quot;</span></span>
<span class="line">        <span class="token comment">#}</span></span>
<span class="line">        storage &quot;raft&quot; <span class="token punctuation">{</span></span>
<span class="line">          path = &quot;/vault/data&quot;</span>
<span class="line">          retry_join <span class="token punctuation">{</span></span>
<span class="line">            leader_api_addr = &quot;https<span class="token punctuation">:</span>//vault<span class="token punctuation">-</span>0.vault<span class="token punctuation">-</span>internal<span class="token punctuation">:</span>8200&quot;</span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        service_registration &quot;kubernetes&quot; <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token key atrule">image</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">repository</span><span class="token punctuation">:</span> hashicorp/vault<span class="token punctuation">-</span>enterprise</span>
<span class="line">    <span class="token key atrule">tag</span><span class="token punctuation">:</span> 1.12.1<span class="token punctuation">-</span>ent</span>
<span class="line">  <span class="token key atrule">extraArgs</span><span class="token punctuation">:</span> <span class="token string">&quot;-config=/vault/userconfig/vault-seal-config/config.hcl&quot;</span></span>
<span class="line">  <span class="token key atrule">extraSecretEnvironmentVars</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">envName</span><span class="token punctuation">:</span> AWS_ACCESS_KEY_ID</span>
<span class="line">      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> eks<span class="token punctuation">-</span>creds</span>
<span class="line">      <span class="token key atrule">secretKey</span><span class="token punctuation">:</span> AWS_ACCESS_KEY_ID</span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">envName</span><span class="token punctuation">:</span> AWS_SECRET_ACCESS_KEY</span>
<span class="line">      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> eks<span class="token punctuation">-</span>creds</span>
<span class="line">      <span class="token key atrule">secretKey</span><span class="token punctuation">:</span> AWS_SECRET_ACCESS_KEY</span>
<span class="line">  <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> userconfig<span class="token punctuation">-</span>vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">      <span class="token key atrule">secret</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">defaultMode</span><span class="token punctuation">:</span> <span class="token number">420</span></span>
<span class="line">        <span class="token key atrule">secretName</span><span class="token punctuation">:</span> vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">  <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /vault/userconfig/vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">      <span class="token key atrule">name</span><span class="token punctuation">:</span> userconfig<span class="token punctuation">-</span>vault<span class="token punctuation">-</span>seal<span class="token punctuation">-</span>config</span>
<span class="line">      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">  <span class="token key atrule">service</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer</span>
<span class="line">    <span class="token key atrule">loadBalancerClass</span><span class="token punctuation">:</span> service.k8s.aws/nlb</span>
<span class="line">    <span class="token key atrule">annotations</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">dataStorage</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">    <span class="token comment">#storageClass: efs-sc</span></span>
<span class="line">    <span class="token key atrule">size</span><span class="token punctuation">:</span> 10Gi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>create by <a href="mailto:rlarlqja1001@gmail.com" target="_blank" rel="noopener noreferrer">rlarlqja1001@gmail.com</a></p>`,10);function S(A,q){const p=u("CodeTabs");return r(),d("div",null,[b,i(p,{id:"30",data:[{id:"인코딩한 Secret 값"},{id:"원본 내용"}]},{title0:n(({value:e,isActive:t})=>[a("인코딩한 Secret 값")]),title1:n(({value:e,isActive:t})=>[a("원본 내용")]),tab0:n(({value:e,isActive:t})=>[_]),tab1:n(({value:e,isActive:t})=>[f]),_:1}),y,i(p,{id:"68",data:[{id:"인코딩한 Secret 값"},{id:"원본 내용"}]},{title0:n(({value:e,isActive:t})=>[a("인코딩한 Secret 값")]),title1:n(({value:e,isActive:t})=>[a("원본 내용")]),tab0:n(({value:e,isActive:t})=>[x]),tab1:n(({value:e,isActive:t})=>[C]),_:1}),I])}const D=o(v,[["render",S],["__file","Vault-KMS-변경법.html.vue"]]),E=JSON.parse('{"path":"/04-HashiCorp/06-Vault/06-Config/Vault-KMS-%EB%B3%80%EA%B2%BD%EB%B2%95.html","title":"EKS Vault auto unseal에 대한 kms ID 변경 시 설정 법","lang":"ko-KR","frontmatter":{"description":"vault container KMS","tag":["kubernetes","KMS"],"author":"gbkim","head":[["meta",{"property":"og:url","content":"https://docmoa.github.io/04-HashiCorp/06-Vault/06-Config/Vault-KMS-%EB%B3%80%EA%B2%BD%EB%B2%95.html"}],["meta",{"property":"og:site_name","content":"docmoa"}],["meta",{"property":"og:title","content":"EKS Vault auto unseal에 대한 kms ID 변경 시 설정 법"}],["meta",{"property":"og:description","content":"vault container KMS"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-07-15T23:31:51.000Z"}],["meta",{"property":"article:author","content":"gbkim"}],["meta",{"property":"article:tag","content":"kubernetes"}],["meta",{"property":"article:tag","content":"KMS"}],["meta",{"property":"article:modified_time","content":"2024-07-15T23:31:51.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"EKS Vault auto unseal에 대한 kms ID 변경 시 설정 법\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-07-15T23:31:51.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"gbkim\\"}]}"]]},"headers":[{"level":2,"title":"1. 사전 요구조건 및 KMS ID 정보 확인","slug":"_1-사전-요구조건-및-kms-id-정보-확인","link":"#_1-사전-요구조건-및-kms-id-정보-확인","children":[{"level":3,"title":"1.1 config.hcl 파일","slug":"_1-1-config-hcl-파일","link":"#_1-1-config-hcl-파일","children":[]},{"level":3,"title":"1.2 초기 vault helm 배포 시 kms ID 설정은 secret으로 관리","slug":"_1-2-초기-vault-helm-배포-시-kms-id-설정은-secret으로-관리","link":"#_1-2-초기-vault-helm-배포-시-kms-id-설정은-secret으로-관리","children":[]},{"level":3,"title":"1.3 kms ID secret","slug":"_1-3-kms-id-secret","link":"#_1-3-kms-id-secret","children":[]}]},{"level":2,"title":"2. KMS ID 변경","slug":"_2-kms-id-변경","link":"#_2-kms-id-변경","children":[{"level":3,"title":"2.1 초기 KMS ID 확인","slug":"_2-1-초기-kms-id-확인","link":"#_2-1-초기-kms-id-확인","children":[]},{"level":3,"title":"2.2 kubernetes에 올라간 config.hcl 정보를 base64 인코딩한 secret 값","slug":"_2-2-kubernetes에-올라간-config-hcl-정보를-base64-인코딩한-secret-값","link":"#_2-2-kubernetes에-올라간-config-hcl-정보를-base64-인코딩한-secret-값","children":[]},{"level":3,"title":"2.3 암호화 정보 복호화","slug":"_2-3-암호화-정보-복호화","link":"#_2-3-암호화-정보-복호화","children":[]},{"level":3,"title":"2.3 vault 배포 시 Container 내부 KMS ID 값 확인","slug":"_2-3-vault-배포-시-container-내부-kms-id-값-확인","link":"#_2-3-vault-배포-시-container-내부-kms-id-값-확인","children":[]},{"level":3,"title":"2.3 변경 되는 KMS ID 변경","slug":"_2-3-변경-되는-kms-id-변경","link":"#_2-3-변경-되는-kms-id-변경","children":[]},{"level":3,"title":"2.4 변경 된 config.hcl 파일 secret update","slug":"_2-4-변경-된-config-hcl-파일-secret-update","link":"#_2-4-변경-된-config-hcl-파일-secret-update","children":[]},{"level":3,"title":"2.5 변경 된 kubernetes에 올라간 config.hcl 정보가 암호화 된 secret 값","slug":"_2-5-변경-된-kubernetes에-올라간-config-hcl-정보가-암호화-된-secret-값","link":"#_2-5-변경-된-kubernetes에-올라간-config-hcl-정보가-암호화-된-secret-값","children":[]},{"level":3,"title":"2.6 변경 된 암호화 정보 복호화","slug":"_2-6-변경-된-암호화-정보-복호화","link":"#_2-6-변경-된-암호화-정보-복호화","children":[]},{"level":3,"title":"2.7 변경 된 secret 정보가 실제 pod 내 적용 되어 있는 확인","slug":"_2-7-변경-된-secret-정보가-실제-pod-내-적용-되어-있는-확인","link":"#_2-7-변경-된-secret-정보가-실제-pod-내-적용-되어-있는-확인","children":[]},{"level":3,"title":"2.8 KMS ID 변경 이후 auto-unseal 정상 작동 확인","slug":"_2-8-kms-id-변경-이후-auto-unseal-정상-작동-확인","link":"#_2-8-kms-id-변경-이후-auto-unseal-정상-작동-확인","children":[]}]},{"level":2,"title":"3. values.yaml","slug":"_3-values-yaml","link":"#_3-values-yaml","children":[]}],"git":{"createdTime":1721022299000,"updatedTime":1721086311000,"contributors":[{"name":"Great-Stone","email":"hahohh@gmail.com","commits":1},{"name":"ung","email":"ung@mz.co.kr","commits":1}]},"readingTime":{"minutes":5.73,"words":344},"filePathRelative":"04-HashiCorp/06-Vault/06-Config/Vault-KMS-변경법.md","localizedDate":"2024년 7월 15일","excerpt":"\\n<h2>1. 사전 요구조건 및 KMS ID 정보 확인</h2>\\n<h3>1.1 config.hcl 파일</h3>\\n<div class=\\"language-text\\" data-highlighter=\\"prismjs\\" data-ext=\\"text\\" data-title=\\"text\\"><pre class=\\"language-text\\"><code><span class=\\"line\\">seal \\"awskms\\" {</span>\\n<span class=\\"line\\">  region     = \\"ap-northeast-2\\"</span>\\n<span class=\\"line\\">  kms_key_id = \\"[kms_key_id]\\"</span>\\n<span class=\\"line\\">}</span>\\n<span class=\\"line\\"></span></code></pre></div>","copyright":{"author":"gbkim"}}');export{D as comp,E as data};
