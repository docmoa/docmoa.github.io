import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as n,c as a,h as e}from"./app-DVMlqOhY.js";const p={},l=e(`<h1 id="containerd를-런타임으로-사용한-kubernetes-설치" tabindex="-1"><a class="header-anchor" href="#containerd를-런타임으로-사용한-kubernetes-설치"><span>containerd를 런타임으로 사용한 Kubernetes 설치</span></a></h1><ul><li>docker가 없어도 k8s를 올릴 수 있다!</li></ul><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 먼저 설치하여 환경파일을 가져오고 원하는 버전을 설치한다.</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> containerd <span class="token parameter variable">-y</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/containerd</span>
<span class="line"></span>
<span class="line">containerd config default <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/containerd/config.toml</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> systemctl stop containerd</span>
<span class="line"></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-LO</span> https://github.com/containerd/containerd/releases/download/v1.4.4/containerd-1.4.4-linux-amd64.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token function">tar</span> xvf containerd-1.4.4-linux-amd64.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token function">rm</span> containerd-1.4.4-linux-amd64.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> bin/* /usr/bin/</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> systemctl start containerd</span>
<span class="line"></span>
<span class="line"><span class="token function">rm</span> <span class="token parameter variable">-rf</span> bin</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> systemctl status containerd <span class="token parameter variable">--lines</span> <span class="token number">1</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># k8s 설치시작</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">-s</span> https://packages.cloud.google.com/apt/doc/apt-key.gpg <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> apt-add-repository <span class="token string">&quot;deb http://apt.kubernetes.io/ kubernetes-xenial main&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> kubeadm kubelet kubectl <span class="token parameter variable">-y</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> apt-mark hold kubeadm kubelet kubectl containerd</span>
<span class="line"></span>
<span class="line"><span class="token comment">#echo &#39;net.bridge.bridge-nf-call-iptables = 1&#39; | sudo tee -a /etc/sysctl.conf</span></span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">SOURCE_FILE</span><span class="token operator">=</span><span class="token string">&quot;/etc/sysctl.conf&quot;</span></span>
<span class="line"><span class="token assign-left variable">LINE_INPUT</span><span class="token operator">=</span><span class="token string">&quot;net.bridge.bridge-nf-call-iptables = 1&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">grep</span> <span class="token parameter variable">-qF</span> <span class="token string">&quot;<span class="token variable">$LINE_INPUT</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$SOURCE_FILE</span>&quot;</span>  <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$LINE_INPUT</span>&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;<span class="token variable">$SOURCE_FILE</span>&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token builtin class-name">echo</span> <span class="token string">&#39;1&#39;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /proc/sys/net/ipv4/ip_forward</span>
<span class="line"></span>
<span class="line"><span class="token function">cat</span> /proc/sys/net/ipv4/ip_forward</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sysctl</span> <span class="token parameter variable">--system</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> modprobe overlay</span>
<span class="line"><span class="token function">sudo</span> modprobe br_netfilter</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> swapoff <span class="token parameter variable">-a</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-ri</span> <span class="token string">&#39;/\\sswap\\s/s/^#?/#/&#39;</span> /etc/fstab</span>
<span class="line"></span>
<span class="line"><span class="token function">cat</span> /etc/fstab</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="후속작업" tabindex="-1"><a class="header-anchor" href="#후속작업"><span>후속작업</span></a></h1><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># k8s master server 설정</span></span>
<span class="line"><span class="token function">sudo</span> kubeadm config images pull</span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">IP_ADDR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">hostname</span> <span class="token parameter variable">-I</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">\`</span></span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> kubeadm init --pod-network-cidr<span class="token operator">=</span><span class="token number">10.244</span>.0.0/16 --apiserver-advertise-address<span class="token operator">=</span><span class="token variable">\${IP_ADDR}</span></span>
<span class="line"></span>
<span class="line"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token environment constant">$HOME</span>/.kube</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> <span class="token parameter variable">-i</span> /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-g</span><span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config</span>
<span class="line"></span>
<span class="line"><span class="token comment"># cni 설치(weave)</span></span>
<span class="line">kubectl apply <span class="token parameter variable">-f</span> <span class="token string">&quot;https://cloud.weave.works/k8s/net?k8s-version=<span class="token variable"><span class="token variable">$(</span>kubectl version <span class="token operator">|</span> base64 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">&#39;\\n&#39;</span><span class="token variable">)</span></span>&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">#kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> ./crictl.yaml /etc/crictl.yaml</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> crictl images</span>
<span class="line"></span>
<span class="line"><span class="token function">watch</span> <span class="token parameter variable">-n</span> <span class="token number">5</span> <span class="token string">&quot;kubectl get nodes&quot;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),t=[l];function i(c,o){return n(),a("div",null,t)}const u=s(p,[["render",i],["__file","kubernetes_with_out_docker.html.vue"]]),k=JSON.parse(`{"path":"/07-Kubernetes/02-Config/kubernetes_with_out_docker.html","title":"containerd를 런타임으로 사용한 Kubernetes 설치","lang":"ko-KR","frontmatter":{"description":"kubernetes_with_out_docker","tag":["kubernetes","docker아님","containerd"],"head":[["meta",{"property":"og:url","content":"https://docmoa.github.io/07-Kubernetes/02-Config/kubernetes_with_out_docker.html"}],["meta",{"property":"og:site_name","content":"docmoa"}],["meta",{"property":"og:title","content":"containerd를 런타임으로 사용한 Kubernetes 설치"}],["meta",{"property":"og:description","content":"kubernetes_with_out_docker"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-06-26T04:24:29.000Z"}],["meta",{"property":"article:tag","content":"kubernetes"}],["meta",{"property":"article:tag","content":"docker아님"}],["meta",{"property":"article:tag","content":"containerd"}],["meta",{"property":"article:modified_time","content":"2024-06-26T04:24:29.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"containerd를 런타임으로 사용한 Kubernetes 설치\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-26T04:24:29.000Z\\",\\"author\\":[]}"]]},"headers":[],"git":{"createdTime":1640606121000,"updatedTime":1719375869000,"contributors":[{"name":"Great-Stone","email":"hahohh@gmail.com","commits":1}]},"readingTime":{"minutes":3.95,"words":237},"filePathRelative":"07-Kubernetes/02-Config/kubernetes_with_out_docker.md","localizedDate":"2021년 12월 27일","excerpt":"\\n<ul>\\n<li>docker가 없어도 k8s를 올릴 수 있다!</li>\\n</ul>\\n<div class=\\"language-bash\\" data-highlighter=\\"prismjs\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"line\\"><span class=\\"token comment\\"># 먼저 설치하여 환경파일을 가져오고 원하는 버전을 설치한다.</span></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">apt-get</span> <span class=\\"token function\\">install</span> containerd <span class=\\"token parameter variable\\">-y</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">mkdir</span> <span class=\\"token parameter variable\\">-p</span> /etc/containerd</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">containerd config default <span class=\\"token operator\\">|</span> <span class=\\"token function\\">sudo</span> <span class=\\"token function\\">tee</span> /etc/containerd/config.toml</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> systemctl stop containerd</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">curl</span> <span class=\\"token parameter variable\\">-LO</span> https://github.com/containerd/containerd/releases/download/v1.4.4/containerd-1.4.4-linux-amd64.tar.gz</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">tar</span> xvf containerd-1.4.4-linux-amd64.tar.gz</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">rm</span> containerd-1.4.4-linux-amd64.tar.gz</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">cp</span> bin/* /usr/bin/</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> systemctl start containerd</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">rm</span> <span class=\\"token parameter variable\\">-rf</span> bin</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> systemctl status containerd <span class=\\"token parameter variable\\">--lines</span> <span class=\\"token number\\">1</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># k8s 설치시작</span></span>\\n<span class=\\"line\\"><span class=\\"token function\\">curl</span> <span class=\\"token parameter variable\\">-s</span> https://packages.cloud.google.com/apt/doc/apt-key.gpg <span class=\\"token operator\\">|</span> <span class=\\"token function\\">sudo</span> apt-key <span class=\\"token function\\">add</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> apt-add-repository <span class=\\"token string\\">\\"deb http://apt.kubernetes.io/ kubernetes-xenial main\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">apt-get</span> <span class=\\"token function\\">install</span> kubeadm kubelet kubectl <span class=\\"token parameter variable\\">-y</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> apt-mark hold kubeadm kubelet kubectl containerd</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token comment\\">#echo 'net.bridge.bridge-nf-call-iptables = 1' | sudo tee -a /etc/sysctl.conf</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">SOURCE_FILE</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"/etc/sysctl.conf\\"</span></span>\\n<span class=\\"line\\"><span class=\\"token assign-left variable\\">LINE_INPUT</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"net.bridge.bridge-nf-call-iptables = 1\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">grep</span> <span class=\\"token parameter variable\\">-qF</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$LINE_INPUT</span>\\"</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$SOURCE_FILE</span>\\"</span>  <span class=\\"token operator\\">||</span> <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$LINE_INPUT</span>\\"</span> <span class=\\"token operator\\">|</span> <span class=\\"token function\\">sudo</span> <span class=\\"token function\\">tee</span> <span class=\\"token parameter variable\\">-a</span> <span class=\\"token string\\">\\"<span class=\\"token variable\\">$SOURCE_FILE</span>\\"</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token builtin class-name\\">echo</span> <span class=\\"token string\\">'1'</span> <span class=\\"token operator\\">|</span> <span class=\\"token function\\">sudo</span> <span class=\\"token function\\">tee</span> /proc/sys/net/ipv4/ip_forward</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">cat</span> /proc/sys/net/ipv4/ip_forward</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">sysctl</span> <span class=\\"token parameter variable\\">--system</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> modprobe overlay</span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> modprobe br_netfilter</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> swapoff <span class=\\"token parameter variable\\">-a</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">sudo</span> <span class=\\"token function\\">sed</span> <span class=\\"token parameter variable\\">-ri</span> <span class=\\"token string\\">'/\\\\sswap\\\\s/s/^#?/#/'</span> /etc/fstab</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token function\\">cat</span> /etc/fstab</span>\\n<span class=\\"line\\"></span></code></pre></div>"}`);export{u as comp,k as data};
