<!doctype html>
<html lang="ko-KR" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.50" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://docmoa.github.io/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-integration-three-methods.html"><meta property="og:site_name" content="docmoa"><meta property="og:title" content="Kubernetes Vault 통합방안 3가지 비교"><meta property="og:description" content="Kubernetes Vault 통합방안 3가지 비교 Sidecar Agent Injector CSI provider Vault Secrets Operator 개요 본 글에서는 HashiCorp Vault 및 Kubernetes 통합을 위해 HashiCorp가 지원하는 세 가지 방법을 자세히 비교한다: 볼트 사이드카 ..."><meta property="og:type" content="article"><meta property="og:image" content="https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214443-sidecar-workflow-v1.png&w=3840&q=75"><meta property="og:locale" content="ko-KR"><meta property="og:updated_time" content="2023-09-26T05:48:30.000Z"><meta property="article:tag" content="vault"><meta property="article:tag" content="kubernetes"><meta property="article:tag" content="secret"><meta property="article:tag" content="VSO"><meta property="article:modified_time" content="2023-09-26T05:48:30.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Kubernetes Vault 통합방안 3가지 비교","image":["https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214443-sidecar-workflow-v1.png&w=3840&q=75","https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214470-csi-workflow-v1.png&w=3840&q=75","https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214683-vault-k8s-auth-blog.png&w=3840&q=75"],"dateModified":"2023-09-26T05:48:30.000Z","author":[]}</script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap"><link rel="icon" href="/logo.png"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><link rel="alternate" type="application/rss+xml" href="https://docmoa.github.io/rss.xml" title="docmoa RSS Feed"><title>Kubernetes Vault 통합방안 3가지 비교 | docmoa</title><meta name="description" content="Kubernetes Vault 통합방안 3가지 비교 Sidecar Agent Injector CSI provider Vault Secrets Operator 개요 본 글에서는 HashiCorp Vault 및 Kubernetes 통합을 위해 HashiCorp가 지원하는 세 가지 방법을 자세히 비교한다: 볼트 사이드카 ...">
    <link rel="preload" href="/assets/style-CkODk6eP.css" as="style"><link rel="stylesheet" href="/assets/style-CkODk6eP.css">
    <link rel="modulepreload" href="/assets/app-DVMlqOhY.js"><link rel="modulepreload" href="/assets/vault-k8s-integration-three-methods.html-ByEw3cVX.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">본문으로 건너뛰기</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.png" alt><!----><span class="vp-site-name hide-in-pad">docmoa</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="docmoa"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->docmoa<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/00-Howto/" aria-label="How To"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-rocket" style=""></span><!--]-->How To<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Infra"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-server" style=""></span>Infra<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/01-Infrastructure/" aria-label="Infrastructure"><!---->Infrastructure<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/02-PrivatePlatform/" aria-label="Private-Platform"><!---->Private-Platform<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/03-PublicCloud/" aria-label="Public-Cloud"><!---->Public-Cloud<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/05-Software/" aria-label="Software"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><!--]-->Software<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/04-HashiCorp/" aria-label="HashiCorp"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-layer-group" style=""></span><!--]-->HashiCorp<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/07-Kubernetes/" aria-label="Kubernetes"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-dharmachakra" style=""></span><!--]-->Kubernetes<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/06-etc/" aria-label="Etc."><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-mug-hot" style=""></span><!--]-->Etc.<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="MORE"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>MORE<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/99-about/01-About.html" aria-label="About"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-house-circle-exclamation" style=""></span><!--]-->About<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/99-about/02-Thanks.html" aria-label="Thank you"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-heart" style=""></span><!--]-->Thank you<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="Recently"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-clock-rotate-left" style=""></span><!--]-->Recently<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/docmoa/docs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="검색"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">검색</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/" aria-label="HashiCorp"><!---->HashiCorp<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">01 Packer</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">02 Vagrant</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">03 Terraform</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">04 Consul</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">05 Boundary</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">06 Vault</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">01 Information</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">02 Secret Engine</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">03 Auth Method</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">04 Use Case</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/API-security.html" aria-label="API 보안을 위한 Vault 활용 (API Key)"><!---->API 보안을 위한 Vault 활용 (API Key)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/argocd-vault-plugin.html" aria-label="ArgoCD Vault Plugin"><!---->ArgoCD Vault Plugin<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/gitlabci-with-vault.html" aria-label="Gitlab 파이프라인의 Secret을 Vault로 관리"><!---->Gitlab 파이프라인의 Secret을 Vault로 관리<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-usecase-csi-injection.html" aria-label="How to integrate Vault with K8s (CSI &amp; Injection &amp; VSO)"><!---->How to integrate Vault with K8s (CSI &amp; Injection &amp; VSO)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/jenkins-pipeilne-vault-approle.html" aria-label="Jenkins Pipeline Vault Approle (with Nomad)"><!---->Jenkins Pipeline Vault Approle (with Nomad)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/jenkins-with-vault.html" aria-label="jenkins with vault"><!---->jenkins with vault<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/jenkins-with-vault-otp.html" aria-label="jenkins with vault otp"><!---->jenkins with vault otp<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-integration-three-methods.html" aria-label="Kubernetes Vault 통합방안 3가지 비교"><!---->Kubernetes Vault 통합방안 3가지 비교<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-manually-using-the-sidecar.html" aria-label="Kubernetes에 Vault Agent(Sidecar) 수동 구성"><!---->Kubernetes에 Vault Agent(Sidecar) 수동 구성<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/sentinel-check-identity-cidr.html" aria-label="Sentinel - (Identity &amp; CIDR)"><!---->Sentinel - (Identity &amp; CIDR)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/terraform-with-aws-secret-engine.html" aria-label="Terraform 코드 상에서 Vault 연동하기"><!---->Terraform 코드 상에서 Vault 연동하기<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/nomad-integration.html" aria-label="Vault &amp; Nomad Integration Test"><!---->Vault &amp; Nomad Integration Test<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/mtls.html" aria-label="Vault PKI - mTLS demo"><!---->Vault PKI - mTLS demo<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/get-all-secret-engine.html" aria-label="Vault Secret Engine 조회 스크립트"><!---->Vault Secret Engine 조회 스크립트<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/secret-sync.html" aria-label="Vault Secret를 AWS Secret manager 연동"><!---->Vault Secret를 AWS Secret manager 연동<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/transit-stress-test.html" aria-label="Vault Stress Test"><!---->Vault Stress Test<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/spring-boot.html" aria-label="Vault로 Spring Boot 구성관리"><!---->Vault로 Spring Boot 구성관리<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/spring-boot-with-vault.html" aria-label="Vault로 Spring Boot 구성관리 aws-auth Version"><!---->Vault로 Spring Boot 구성관리 aws-auth Version<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/mtls-authentication-to-secure-web-services.html" aria-label="Vault를 활용한 mTLS 인증 자동화로 웹 서비스 보안 강화하기"><!---->Vault를 활용한 mTLS 인증 자동화로 웹 서비스 보안 강화하기<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/windows-password-rotation.html" aria-label="Windows Password rotation"><!---->Windows Password rotation<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/04-HashiCorp/06-Vault/04-UseCase/Secured-RAG-with-Vault-on-aws.html" aria-label="안전한 RAG 시스템 구축: HashiCorp Vault와 Amazon Bedrock 활용"><!---->안전한 RAG 시스템 구축: HashiCorp Vault와 Amazon Bedrock 활용<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">05 Trouble Shooting</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">06 Config</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">07 Sentinel Sample</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">07 Nomad</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">08 Updates</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Kubernetes Vault 통합방안 3가지 비교</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="작성일📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-23T13:46:44.000Z"></span><!----><span class="page-reading-time-info" aria-label="읽는 시간⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>약 16 분</span><meta property="timeRequired" content="PT16M"></span><!----><span class="page-tag-info" aria-label="태그🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color2 clickable" role="navigation">vault</span><span class="page-tag-item color2 clickable" role="navigation">kubernetes</span><span class="page-tag-item color8 clickable" role="navigation">secret</span><span class="page-tag-item color8 clickable" role="navigation">VSO</span><!--]--><meta property="keywords" content="vault,kubernetes,secret,VSO"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">이 페이지에서<button type="button" class="print-button" title="인쇄"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-vault-sidecar-agent-injector">1. Vault Sidecar Agent Injector</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-vault-csi-provider">2. Vault CSI provider</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-vault-secrets-operator">3. Vault Secrets Operator</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-설계-고려사항">4. 설계 고려사항</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-similarities">5. Similarities</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-vault-s-kubernetes-auth-workflow">6. Vault’s Kubernetes auth workflow</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-differences">7. Differences</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-comparison-chart">8. Comparison Chart</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_9-going-beyond-the-native-kubernetes-secrets">9. Going Beyond the Native Kubernetes Secrets</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_10-summary">10. Summary</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_10-additional-resources">10. Additional Resources</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="kubernetes-vault-통합방안-3가지-비교" tabindex="-1"><a class="header-anchor" href="#kubernetes-vault-통합방안-3가지-비교"><span>Kubernetes Vault 통합방안 3가지 비교</span></a></h1><ul><li>Sidecar Agent Injector</li><li>CSI provider</li><li>Vault Secrets Operator</li></ul><div class="hint-container info"><p class="hint-container-title">개요</p><p>본 글에서는 HashiCorp Vault 및 Kubernetes 통합을 위해 HashiCorp가 지원하는 세 가지 방법을 자세히 비교한다:</p><ol><li>볼트 사이드카 에이전트 인젝터(Sidecar Agent Injector)</li><li>볼트 컨테이너 스토리지 인터페이스 공급자(Container Storage Interface (CSI) provider)</li><li>볼트 시크릿 오퍼레이터(Secrets Operator)</li></ol><p>각 방법에 대한 실용적인 지침(guidance)을 제공하여 사용 사례에 가장 적합한 방법을 이해하고 선택할 수 있도록 안내한다.</p></div><div class="hint-container warning"><p class="hint-container-title">참고</p><p>본 포스트는 제품 설명서나 단계별(step-by-step) 구현 가이드가 아니며, HashiCorp Vault 및 Kubernetes에 익숙하고 시크릿 관리 개념에 대한 기본적인 이해가 있는 데브옵스 실무자를 위한 문서이다.</p></div><h2 id="_1-vault-sidecar-agent-injector" tabindex="-1"><a class="header-anchor" href="#_1-vault-sidecar-agent-injector"><span>1. Vault Sidecar Agent Injector</span></a></h2><p>Vault 사이드카 에이전트 인젝터(<a href="https://www.vaultproject.io/docs/platform/k8s/injector?_gl=1*67yi4g*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTM5Nzc3NC45LjEuMTY4MTM5ODY2NC4wLjAuMA.." target="_blank" rel="noopener noreferrer">Vault Sidecar Agent Injector</a>)는 사이드카 패턴(<a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/sidecar" target="_blank" rel="noopener noreferrer">sidecar pattern</a>)을 활용하여 공유 메모리 볼륨에 볼트 시크릿을 렌더링하는 Vault 에이전트 컨테이너를 포함하도록 파드 사양(spec)을 변경한다. 공유 볼륨에 시크릿을 렌더링함으로써, 파드 내의 컨테이너는 Vault를 인식(Vault-aware)하지 않고도 Vault 시크릿을 사용할 수 있다.<br> 인젝터는 Kubernetes Mutating Webhook Controller이다. Controller는 파드 이벤트를 가로채고(intercepts) 요청 내에 어노테이션이 있는 경우 파드에 변형(mutations)을 적용한다. 이 기능은 <a href="https://github.com/hashicorp/vault-k8s" target="_blank" rel="noopener noreferrer">vault-k8s</a> 프로젝트에 의해 제공되며, Vault Helm 차트를 사용하여 자동으로 설치 및 구성할 수 있다.</p><figure><img src="https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214443-sidecar-workflow-v1.png&amp;w=3840&amp;q=75" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_2-vault-csi-provider" tabindex="-1"><a class="header-anchor" href="#_2-vault-csi-provider"><span>2. Vault CSI provider</span></a></h2><p>파드가 임시(ephemeral) <a href="https://github.com/kubernetes-sigs/secrets-store-csi-driver" target="_blank" rel="noopener noreferrer">CSI Secrets Store</a> 볼륨을 사용하여 볼트 시크릿을 사용할 수 있도록 하는 것이 <a href="https://www.vaultproject.io/docs/platform/k8s/csi?_gl=1*8ev72c*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTM5Nzc3NC45LjEuMTY4MTM5ODc3NC4wLjAuMA.." target="_blank" rel="noopener noreferrer">Vault CSI provider</a>이다.<br> 높은 수준(high level)에서, CSI Secretes Store 드라이버는 사용자가 <code>SecretProviderClass</code> 오브젝트를 생성할 수 있게 해준다. 이 오브젝트는 사용할 시크릿 프로바이더와 검색할 시크릿을 정의한다. CSI 볼륨을 요청하는 파드가 생성되면, CSI Secretes Store 드라이버는 프로바이더가 <code>vault</code>인 경우 요청을 Vault CSI Provider에게 보낸다. 그러면 Vault CSI Provider는 지정된 <code>SecretProviderClass</code>와 파드의 서비스 어카운트(SA)을 사용하여 볼트에서 시크릿을 검색하고 파드의 CSI 볼륨에 마운트한다. 시크릿은 Vault에서 검색되어 <code>ContainerCreation</code> 단계에서 CSI 시크릿 스토어 볼륨에 채워진다. 즉, Vault에서 시크릿을 읽고 볼륨에 쓰기 전까지는 파드가 시작되지 않도록 차단된다.</p><figure><img src="https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214470-csi-workflow-v1.png&amp;w=3840&amp;q=75" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_3-vault-secrets-operator" tabindex="-1"><a class="header-anchor" href="#_3-vault-secrets-operator"><span>3. Vault Secrets Operator</span></a></h2><p><a href="https://github.com/hashicorp/vault-secrets-operator/" target="_blank" rel="noopener noreferrer">Vault Secrets Operator</a>는 기본적으로 Vault secrets을 Kubernetes Secrets에 동기화할 책임이 있는(responsible) CRD 집합으로 쿠버네티스 시크릿 오퍼레이터(Kubernetes Secrets Operator)를 구현하는 새로운 통합 방법이다.</p><figure><img src="/assets/1691011664-k8s-vault-sidecar-workflow-copy-2x-CSoO09IP.webp" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>오퍼레이터는 하나 이상의 볼트 서버 인스턴스에서 정적(static), 동적(dynamic) 및 PKI 기반(PKI-based) 시크릿을 포함한 시크릿 관리의 전체 라이프사이클 동기화를 지원한다. 또한 오퍼레이터는 시크릿 로테이션(secret rotation)을 관리하고 <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener noreferrer">Deployment</a>의 <a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#rollout" target="_blank" rel="noopener noreferrer">rolling update</a>를 통해 애플리케이션에 직접 알리거나(notifying) 롤링 업데이트를 트리거(triggering)하는 등 로테이션 후 작업을 수행할 수 있다.</p><blockquote><p>참고 :</p><ul><li><p><a href="https://kubernetes.io/ko/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener noreferrer">커스텀 리소스(Custom Resource) 란?</a></p></li><li><p><a href="https://kubernetes.io/ko/docs/concepts/extend-kubernetes/operator/" target="_blank" rel="noopener noreferrer">오퍼레이터(operator) 패턴이란?</a></p></li></ul></blockquote><h2 id="_4-설계-고려사항" tabindex="-1"><a class="header-anchor" href="#_4-설계-고려사항"><span>4. 설계 고려사항</span></a></h2><p>두 솔루션 간에는 몇 가지 유사점과 차이점이 있으며, Kubernetes 환경에서 시크릿 관리 전략을 설계하고 구현할 때 고려해야 할 사항이다.</p><table><thead><tr><th>고려사항</th><th>설명</th></tr></thead><tbody><tr><td>Secret projections</td><td>모든 애플리케이션은 특정 방식으로 시크릿을 제공해야 한다. 일반적으로, 애플리케이션은 환경 변수로 내보내거나(exported) 애플리케이션 시작(startup) 시 애플리케이션이 읽을 수 있는 파일에 시크릿을 기록한다. 사용할 올바른 방법을 결정할 때 이 점을 염두에 두자.</td></tr><tr><td>Secret scope</td><td>일부 애플리케이션은 데이터센터, 엣지 또는 퍼블릭 클라우드의 여러 Kubernetes 환경(예: dev, qa, producton)에 배포된다. 일부 서비스는 가상 머신, 서버리스 또는 기타 클라우드 관리형(cloud-managed) 서비스에 배포된 외부 Kubernetes 환경에서 실행되기도 한다. <br>이러한 애플리케이션이 다양한 이기종 환경 전반에서 일련의 시크릿을 공유해야 하는 시나리오에 직면할 수 있다. 키의 범위(Scoping)를 올바르게 설정하여 Kubernetes 환경에 로컬 또는 여러 환경에 걸쳐 전역(global)으로 설정하면 각 애플리케이션이 배포된 환경 내에서 자체 키 집합에 쉽고 안전하게 액세스할 수 있다.</td></tr><tr><td>Secret types</td><td>시크릿은 텍스트 파일, 바이너리 파일, 토큰 또는 인증서 등이 대표적이다. 정적으로 생성하거나 동적으로 생성할 수도 있다. 영구적으로 유효하거나 시간 제한적(time-scoped)으로 유효할 수 있다. 또한 크기도 다양하다. 애플리케이션에 필요한 시크릿 유형과 애플리케이션에 투영(projected)되는 방식을 고려해야 한다.</td></tr><tr><td>Secret definition</td><td>또한 각 비밀이 정의, 생성, 업데이트 및 제거되는 방법과 해당 프로세스와 관련된 도구도 고려해야 한다.</td></tr><tr><td>Encryption</td><td>미사용(at rest) 시크릿과 전송(transit) 중인 시크릿을 모두 암호화하는 것은 많은 기업 조직에서 중요한 요구 사항이다.</td></tr><tr><td>Governance</td><td>애플리케이션과 비밀은 다대다(many-to-many) 관계를 가질 수 있으므로 애플리케이션이 각각의 비밀을 검색할 수 있도록 액세스 권한을 부여할 때 신중한 고려가 필요하다. 애플리케이션과 암호의 수(scale)가 증가함에 따라 액세스 정책 관리의 어려움도 커진다.</td></tr><tr><td>Secrets updates and rotation</td><td>시크릿은 임대(leased), 시간 범위(time-scoped) 지정 또는 자동으로 순환(rotated)될 수 있으며, 각 시나리오는 새 시크릿이 애플리케이션 파드에 올바르게 전파되도록 프로그래밍(programmatic) 프로세스를 거쳐야 한다.</td></tr><tr><td>Secret caching</td><td>특정 쿠버네티스 환경(예: edge 또는 retail)에서는 환경과 시크릿 스토리지 간의 통신 또는 네트워크 장애가 발생할 경우 시크릿 캐싱이 필요할 수 있다.</td></tr><tr><td>Auditability</td><td>모든 시크릿 액세스 정보를 자세히 설명하는 시크릿 액세스 감사 로그를 보관하는 것은 시크릿 액세스(secret-access) 이벤트의 추적성(traceability)을 보장(Keeping)하는 데 중요하다.</td></tr></tbody></table><p>이러한 설계 고려 사항을 염두에 두고, 두 통합 솔루션의 유사점(similarities)과 차이점(differences)을 살펴본다.</p><h2 id="_5-similarities" tabindex="-1"><a class="header-anchor" href="#_5-similarities"><span>5. Similarities</span></a></h2><p>Vault <code>Operator</code>, <code>CSI</code> 및 <code>Sidecar</code> 솔루션:</p><ul><li><p>Vault에 저장된 다양한 유형의 시크릿 검색을 간소화(Simplify)하고 사소하지 않은(not-so-trivial) Vault 프로세스를 인식하지 않고도 Kubernetes에서 실행 중인 대상 파드에 시크릿을 노출한다. 중요한 점은 이러한 솔루션을 사용하기 위해 애플리케이션 로직이나 코드를 변경할 필요가 없기 때문에 브라운필드(brownfield) 애플리케이션을 Kubernetes로 더 쉽게 마이그레이션할 수 있다는 것이다. 그린필드(greenfield) 애플리케이션을 작업하는 개발자는 <a href="https://www.vaultproject.io/api/libraries?_gl=1*1kt7rwn*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjE2OTUuMC4wLjA." target="_blank" rel="noopener noreferrer">Vault SDKs</a>를 활용하여 Vault와 직접 통합할 수 있다.</p></li><li><p>모든 유형의 Vault <a href="https://www.vaultproject.io/docs/secrets?_gl=1*1xda1jz*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjE4MjUuMC4wLjA." target="_blank" rel="noopener noreferrer">secrets engines</a>을 지원한다. 즉, 정적 키-값(key-value) 시크릿부터 동적으로 생성된 데이터베이스 자격 증명(credentials), 사용자 정의 TTL이 포함된 TLS 인증서까지 광범위한(extensive) 시크릿 유형 세트를 활용할 수 있다.</p></li><li><p>애플리케이션의 Kubernetes 포드 서비스 어카운트(SA) 토큰을 <a href="https://www.hashicorp.com/resources/secret-zero-mitigating-the-risk-of-secret-introduction-with-vault" target="_blank" rel="noopener noreferrer">“Secret Zero”</a>로 활용하여 <a href="https://developer.hashicorp.com/vault/docs/auth/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes Auth Method</a>를 통해 Vault에 인증한다.<br> 즉, Vault에 인증할 때 애플리케이션 파드를 식별하기 위해 또 다른 별도의 ID를 관리할 필요가 없다.</p></li></ul><figure><img src="https://www.hashicorp.com/_next/image?url=https%3A%2F%2Fwww.datocms-assets.com%2F2885%2F1643214683-vault-k8s-auth-blog.png&amp;w=3840&amp;q=75" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_6-vault-s-kubernetes-auth-workflow" tabindex="-1"><a class="header-anchor" href="#_6-vault-s-kubernetes-auth-workflow"><span>6. Vault’s Kubernetes auth workflow</span></a></h2><ul><li>애플리케이션을 배포하기 전에 원하는 시크릿이 Vault 내에 존재해야 한다.</li><li>원하는 시크릿에 액세스할 수 있는 정책으로 파드의 서비스 어카운트가 Vault 역할에 바인딩(bound)되어야 한다.<br> (즉, 시크릿에 대한 액세스 권한을 부여하는 데 Kubernetes RBAC이 사용되지 않아야 함).</li><li>Helm을 통해 배포 가능</li><li>파드가 시작되기 전에 볼트에서 시크릿을 성공적으로 검색(retrieving)해야 한다.</li><li>사용자 정의(user-defined) 파드 어노테이션을 사용하여 Vault에서 필요한 시크릿을 검색(retrieve)한다.</li><li><a href="https://www.vaultproject.io/docs/agent/template?_gl=1*x61qo5*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjIyOTcuMC4wLjA.#renewals-and-updating-secrets" target="_blank" rel="noopener noreferrer">Sidecar Injector Service</a>와 <a href="https://secrets-store-csi-driver.sigs.k8s.io/topics/secret-auto-rotation.html" target="_blank" rel="noopener noreferrer">CSI Driver</a>는 모두 자동으로 시크릿/토큰을 갱신(renew), 회전(rotate) 및 가져올(fetch) 수 있다.</li></ul><h2 id="_7-differences" tabindex="-1"><a class="header-anchor" href="#_7-differences"><span>7. Differences</span></a></h2><p>세 가지 솔루션의 차이점은 다음과 같다:</p><ul><li>사이드카 에이전트 인젝터 솔루션은 두 가지 요소로 구성된다: <ul><li><strong>Sidecar Service Injector</strong>는 클러스터 서비스로 배포되며, Kubernetes API Server 파드 이벤트를 가로채고 필요한 사이드카 컨테이너를 추가하기 위해 파드 스펙을 변경하는 역할을 한다.</li><li><strong>Vault Sidecar Container</strong>는 각 애플리케이션 파드와 함께 배포되며 Vault에 인증하고, Vault에서 시크릿을 검색하고, 애플리케이션이 사용할 시크릿을 렌더링하는 것을 담당한다.</li></ul></li><li>이와 대조적으로, <strong>Vault CSI Driver</strong>는 쿠버네티스 클러스터의 모든 노드에 데몬셋으로 배포되며, 지정된 시크릿 프로바이더 클래스와 파드의 서비스 계정을 사용하여 Vault에서 시크릿을 검색하고 파드의 CSI 볼륨에 마운트한다.</li><li>또한 <strong>Vault Operator</strong>는 시크릿 로테이션을 관리하고 디플로이먼트의 롤링 업데이트를 통해(또는 트리거를 통해) 애플리케이션에 직접 알리는 등 로테이션 후 작업을 수행할 수 있다.</li><li>지원되는 인증 방법의 차이는 다음과 같다: <ul><li>Sidecar Agent Injector는 모든(<a href="https://www.vaultproject.io/docs/platform/k8s/injector/annotations?_gl=1*drq9u5*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjI4ODYuMC4wLjA.#vault-hashicorp-com-auth-path" target="_blank" rel="noopener noreferrer">all</a>) Vault 자동 인증(<a href="https://www.vaultproject.io/docs/agent/autoauth/methods?_gl=1*jv9vba*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjI4ODguMC4wLjA." target="_blank" rel="noopener noreferrer">auto-auth</a>) 방법을 지원</li><li>Sidecar CSI Driver는 Vault의 쿠버네티스 인증 방법(<a href="https://www.vaultproject.io/docs/platform/k8s/csi/configurations?_gl=1*1srn571*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjI4OTguMC4wLjA.#vaultkubernetesmountpath" target="_blank" rel="noopener noreferrer">Vault’s Kubernetes auth method</a>)만 지원</li><li>Vault Operator는 현재 쿠버네티스 인증 방법만 지원</li></ul></li><li>모든 애플리케이션 파드와 함께 실행되는 사이드카 컨테이너는 자동 인증, 템플릿, 캐싱과 같은 강력한 기능 세트를 제공하는 <a href="https://www.vaultproject.io/docs/agent?_gl=1*138ihg*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjI5ODIuMC4wLjA." target="_blank" rel="noopener noreferrer">Vault Agent</a>를 사용한다. CSI Driver는 Vault Agent를 사용하지 않으므로 이러한 기능을 제공하지 않는다.</li><li><strong>Vault Operator</strong>에는 거버넌스 보고(governance reporting)를 위한 Promethus 오퍼레이터에 대한 지원이 포함되어 있다.</li><li><strong>Vault CSI Driver</strong>는 Vault 시크릿을 쿠버네티스 시크릿과 환경 변수로 렌더링하는 것을 지원한다. Sidecar Injector Service는 시크릿을 쿠버네티스 시크릿으로 렌더링하는 것을 지원하지 않지만, 에이전트 템플릿(<a href="https://developer.hashicorp.com/vault/docs/platform/k8s/injector/examples?ajs_aid=d3785cda-6801-454c-8c44-fb6ad1c625e3&amp;_gl=1*1ly52in*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjMyNDUuMC4wLjA.&amp;product_intent=vault#environment-variable-example" target="_blank" rel="noopener noreferrer">agent templating</a>)을 사용하여 시크릿을 환경 변수로 렌더링하는 방법이 있다.</li><li>CSI Driver는 <code>hostPath</code>를 사용하여 임시 볼륨을 파드에 마운트하는데, 일부 컨테이너 플랫폼(예: OpenShift)은 기본적으로 이 기능을 비활성화한다. 반면, Sidecar Agent Service는 인메모리(in-memory) <em>tmpfs</em> 볼륨을 사용한다.</li><li>Sidecar Injector Service는 자동으로(<a href="https://www.vaultproject.io/docs/agent/template?_gl=1*73vpv8*_ga*MjA5MTM1MTczLjE2ODA2MDU3MjM.*_ga_P7S46ZYEKW*MTY4MTQ2MTI4NS4xMS4xLjE2ODE0NjMzMzQuMC4wLjA.#renewals-and-updating-secrets" target="_blank" rel="noopener noreferrer">automatically</a>) 시크릿/토큰을 갱신, 회전 및 패치(fetches)를 지원하지만, CSI Driver는 이를 지원하지 않는다.</li></ul><h2 id="_8-comparison-chart" tabindex="-1"><a class="header-anchor" href="#_8-comparison-chart"><span>8. Comparison Chart</span></a></h2><p>아래 표는 두 솔루션을 개략적(high-level)으로 비교한 것이다:</p><table><thead><tr><th></th><th style="text-align:center;">Sidecar</th><th style="text-align:center;">CSI</th><th style="text-align:center;">Vault Operator</th></tr></thead><tbody><tr><td>Secret projection</td><td style="text-align:center;">공유 메모리 볼륨<br>환경 변수*</td><td style="text-align:center;">임시 디스크<br>환경변수<br>쿠버네티스 시크릿</td><td style="text-align:center;">쿠버네티스 시크릿<br>쿠버네티스 시크릿 볼륨<br>환경변수</td></tr><tr><td>Secret scope</td><td style="text-align:center;">전역(Global)</td><td style="text-align:center;">전역(Global)</td><td style="text-align:center;">전역(Global)</td></tr><tr><td>Secret types</td><td style="text-align:center;">모든 볼트 시크릿 엔진<br>(정적 &amp; 동적)</td><td style="text-align:center;">모든 볼트 시크릿 엔진<br>(정적 &amp; 동적)</td><td style="text-align:center;">모든 볼트 시크릿 엔진<br>(정적 &amp; 동적)</td></tr><tr><td>Secret templating</td><td style="text-align:center;">✅</td><td style="text-align:center;">❌</td><td style="text-align:center;">✅(+1.15)</td></tr><tr><td>Secret size limit</td><td style="text-align:center;">Vault w/Consul<br>Backend: 512 KB(기본)<br>제한없음<br><br>Vault w/Integrated Storage<br>Backend: 1MiB(기본)<br>제한없음</td><td style="text-align:center;">Vault w/Consul<br>Backend: 512 KB(기본)<br>제한없음<br><br>Vault w/Integrated Storage<br>Backend: 1MiB(기본)<br>제한없음</td><td style="text-align:center;">Vault w/Consul<br>Backend: 512 KB(기본)<br>제한없음<br><br>Vault w/Integrated Storage<br>Backend: 1MiB(기본)<br>제한없음</td></tr><tr><td>Secret definitions</td><td style="text-align:center;">Vault CLI / API / UI</td><td style="text-align:center;">Vault CLI / API / UI</td><td style="text-align:center;">Vault CLI / API / UI</td></tr><tr><td>Encryption</td><td style="text-align:center;">지원(at rest &amp; in-transit)</td><td style="text-align:center;">지원(at rest &amp; in-transit)</td><td style="text-align:center;">at-rest : <code>etcd</code> 저장소 암호화 시<br>in-transit : TLS 사용 시</td></tr><tr><td>Secret rotation</td><td style="text-align:center;">✅</td><td style="text-align:center;">❌</td><td style="text-align:center;">✅</td></tr><tr><td>Secret caching</td><td style="text-align:center;">✅</td><td style="text-align:center;">❌</td><td style="text-align:center;">✅</td></tr><tr><td>Auditability</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr><tr><td>Deployment method</td><td style="text-align:center;">1개의 공유된 K8s 클러스터 서비스<br>+<br>1개의 사이드카 컨테이너</td><td style="text-align:center;">데몬셋</td><td style="text-align:center;">디플로이먼트</td></tr><tr><td>Vault agent support</td><td style="text-align:center;">✅</td><td style="text-align:center;">❌</td><td style="text-align:center;">❌</td></tr><tr><td>Helm support</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td><td style="text-align:center;">✅</td></tr><tr><td>Custom Support</td><td style="text-align:center;">❌</td><td style="text-align:center;">❌</td><td style="text-align:center;">✅</td></tr><tr><td>K8s Secrets<br>drift detection<br>and automation<br>remediation</td><td style="text-align:center;">❌</td><td style="text-align:center;">❌</td><td style="text-align:center;">✅</td></tr></tbody></table><blockquote><p>***** achieved through <a href="https://www.vaultproject.io/docs/platform/k8s/injector/examples#environment-variable-example" target="_blank" rel="noopener noreferrer">Agent templating</a></p></blockquote><h2 id="_9-going-beyond-the-native-kubernetes-secrets" tabindex="-1"><a class="header-anchor" href="#_9-going-beyond-the-native-kubernetes-secrets"><span>9. Going Beyond the Native Kubernetes Secrets</span></a></h2><p>겉으로 보기에 Kubernetes native secrets은 위에 제시된 두 가지 접근 방식과 비슷해 보일 수 있지만, 두 접근 방식에는 큰 차이점이 있다:</p><ul><li><p>Kubernetes 시크릿 관리 솔루션이 <em>아닙니다</em>. 기본적으로 시크릿을 지원하지만, 이는 엔터프라이즈 시크릿 관리 솔루션과는 상당히 다르다. Kubernetes 시크릿은 클러스터로만 범위가 제한되며, 많은 애플리케이션은 일부 서비스를 Kubernetes 외부 또는 다른 Kubernetes 클러스터에서 실행한다. 따라서 설계 프로세스의 일부로 시크릿 범위를 고려하는 것이 중요하다. 이러한 애플리케이션이 Kubernetes 환경 외부에서 Kubernetes 시크릿을 사용하도록 하면 번거롭고 인증 및 권한 부여 문제가 발생할 수 있다.</p></li><li><p>Kubernetes 시크릿은 본질적으로(in nature) 정적(static)이다. 시크릿은 <code>kubectl</code> 또는 <code>Kubernetes API</code>를 사용하여 정의할 수 있지만, 일단 정의되면 <code>etcd</code>에 저장되고 파드를 생성하는 동안에만 파드에 제공된다. 이로 인해 시크릿이 오래되거나, 구식이거나(outdated), 만료되는 시나리오가 발생할 수 있으며, 시크릿을 업데이트하고 회전하기 위해 추가 워크플로우가 필요하고 새 버전의 시크릿을 사용하기 위해 애플리케이션을 다시 배포(re-deploying)해야 한다. 이로 인해 복잡성(complexity)이 가중되고 시간이 낭비될 수 있다. 따라서 디자인 프로세스의 일부로 시크릿의 최신성(freshness), 업데이트 및 순환에 대한 요구 사항을 고려해야 한다.</p></li><li><p>시크릿 액세스 관리의 보안 모델은 Kubernetes RBAC 모델과 연결되어 있다. 이 모델은 Kubernetes에 익숙하지 않은 사용자에게는 채택하기 어려울 수 있다. 플랫폼에 구애받지 않는(platform-agnostic) 보안 거버넌스 모델을 채택하면 애플리케이션이 실행되는 방식과 위치에 관계없이 애플리케이션에 대한 워크플로우를 채택할 수 있다.</p></li></ul><h2 id="_10-summary" tabindex="-1"><a class="header-anchor" href="#_10-summary"><span>10. Summary</span></a></h2><p>Kubernetes에서 시크릿 관리를 위한 설계는 쉬운 일이 아니다. 각각 장단점이 있는 여러 가지 접근 방식이 있다. 이 게시물에 제시된 옵션을 살펴보고 내부를 이해하여 사용 사례에 가장 적합한 옵션을 결정하시길 적극 권장한다.</p><h2 id="_10-additional-resources" tabindex="-1"><a class="header-anchor" href="#_10-additional-resources"><span>10. Additional Resources</span></a></h2><ul><li><a href="https://medium.com/hashicorp-engineering/hashicorp-vault-delivering-secrets-with-kubernetes-1b358c03b2a3" target="_blank" rel="noopener noreferrer">HashiCorp Vault: Delivering Secrets with Kubernetes</a></li><li><a href="https://www.hashicorp.com/blog/vault-secrets-operator-a-new-method-for-kubernetes-integration" target="_blank" rel="noopener noreferrer">Kubernetes Secrets Vault Operator</a></li><li><a href="https://github.com/hashicorp/vault-secrets-operator/" target="_blank" rel="noopener noreferrer">Kubernetes Vault Operator Repo</a></li><li><a href="https://www.hashicorp.com/blog/retrieve-hashicorp-vault-secrets-with-kubernetes-csi" target="_blank" rel="noopener noreferrer">Retrieve HashiCorp Vault Secrets with Kubernetes CSI</a></li><li><a href="https://learn.hashicorp.com/tutorials/vault/kubernetes-secret-store-driver?in=vault/kubernetes" target="_blank" rel="noopener noreferrer">Mount Vault Secrets Through Container Storage Interface (CSI) Volume</a></li><li><a href="https://learn.hashicorp.com/tutorials/vault/kubernetes-sidecar" target="_blank" rel="noopener noreferrer">Injecting Secrets into Kubernetes Pods via Vault Agent Containers</a></li><li><a href="https://www.vaultproject.io/docs/platform/k8s/injector/annotations" target="_blank" rel="noopener noreferrer">Vault Sidecar Injector Configurations and Examples</a></li><li><a href="https://www.vaultproject.io/docs/platform/k8s/csi/configurations" target="_blank" rel="noopener noreferrer">Vault CSI Driver Configurations and Examples</a></li></ul></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/docmoa/docs/edit/main/docs/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-integration-three-methods.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">마지막 수정: </span><!----></div><div class="contributors"><span class="vp-meta-label">기여자: </span><!--[--><!--[--><span class="vp-meta-info" title="email: hahohh@gmail.com">Great-Stone</span>,<!--]--><!--[--><span class="vp-meta-info" title="email: 40632767+chosam2@users.noreply.github.com">Hyungwook Yu</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/04-HashiCorp/06-Vault/04-UseCase/jenkins-with-vault-otp.html" aria-label="jenkins with vault otp"><div class="hint"><span class="arrow start"></span>이전</div><div class="link"><!---->jenkins with vault otp</div></a><a class="route-link auto-link next" href="/04-HashiCorp/06-Vault/04-UseCase/vault-k8s-manually-using-the-sidecar.html" aria-label="Kubernetes에 Vault Agent(Sidecar) 수동 구성"><div class="hint">다음<span class="arrow end"></span></div><div class="link">Kubernetes에 Vault Agent(Sidecar) 수동 구성<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">CC BY-NC-ND 4.0 Licensed | ⓒ 2021-present docmoa™ contributers all rights reserved.</div><!----></footer></div><!--]--><!--]--><!--[--><!----><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DVMlqOhY.js" defer></script>
  </body>
</html>
